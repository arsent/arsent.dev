<!DOCTYPE html>
<html lang="en">
  <head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link href="https://fonts.googleapis.com/css?family=Merriweather:300|Raleway:400,700" rel="stylesheet">
<link rel="stylesheet" href="/assets/css/style.css">
<title>Mini Notes</title>
<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Mini Notes</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Mini Notes" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="NOTE 1 - Fragment’s view vs instance lifecycles" />
<meta property="og:description" content="NOTE 1 - Fragment’s view vs instance lifecycles" />
<link rel="canonical" href="http://localhost:4000/android/2020/02/01/welcome-to-jekyll.html" />
<meta property="og:url" content="http://localhost:4000/android/2020/02/01/welcome-to-jekyll.html" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-02-01T14:13:56-05:00" />
<script type="application/ld+json">
{"description":"NOTE 1 - Fragment’s view vs instance lifecycles","headline":"Mini Notes","dateModified":"2020-02-01T14:13:56-05:00","datePublished":"2020-02-01T14:13:56-05:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/android/2020/02/01/welcome-to-jekyll.html"},"url":"http://localhost:4000/android/2020/02/01/welcome-to-jekyll.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
</head>
  <body>
    <main class="container">
      <section class="about">
        <a href="/"><img src="/assets/portfolio.png" alt="Arsen T"></a>
        <h2 id="title">
          <a href="/">Arsen T</a>
        </h2>
        <p class="tagline">Android Developer</p>
        <ul class="social"><a href="https://github.com/arsent">
              <li>
                <i class="icon-github-circled"></i>
              </li>
            </a><a href="https://www.linkedin.com/in/arsentumanyan">
              <li>
                <i class="icon-linkedin-squared"></i>
              </li>
            </a></ul><nav class="navigation">
            <ul>
              
                <li>
                  <a href="/cv">CV</a>
                </li>
              
            </ul>
          </nav><p>&copy;
          2020</p>
      </section>
      <section class="content">
        <div class="post-container">
  <a class="post-link" href="/android/2020/02/01/welcome-to-jekyll.html">
    <h2 class="post-title">Mini Notes</h2>
  </a>
  <div class="post-meta">
    <ul class="post-categories"><li>android</li></ul>
    <div class="post-date"><i class="icon-calendar"></i>Feb 1, 2020</div>
  </div>
  <div class="post">
    <h2 id="note-1---fragments-view-vs-instance-lifecycles">NOTE 1 - Fragment’s view vs instance lifecycles</h2>

<p>Use Fragment’s <a href="https://developer.android.com/reference/androidx/fragment/app/Fragment#getViewLifecycleOwner()">view lifecycle</a> when observing lifedata in Fragments. This allows releasing resources when the view is gone but Fragment’s instance is still alive.</p>

<p>When the user navigates away from a fragment but the fragment is still in backstack, Android will keep the instance of the fragment but will kill the view to save resources. When the user goes back to the fragment <code class="highlighter-rouge">onCreateView</code> is called and we create a new view for the same fragment object we had before.</p>

<ul>
  <li>
    <p>LiveData observers - if this is done in <code class="highlighter-rouge">onCreateView</code></p>
  </li>
  <li>
    <p>RV adapter keeps references to ViewHolder instances and those keep references to the inflated views. When we have a reference to the adapter all ViewHolder instances and View instances remain in memory when the user navigates away from the fragment. This gives a benefit of not having to inflate views again when the user comes back but that comes with a cost of keeping them in memory. So, just be aware of this and use it to your advantage.</p>
  </li>
</ul>

<h2 id="note-2---minimize-requestlayout-calls-on-recyclerview">NOTE 2 - Minimize <code class="highlighter-rouge">requestLayout()</code> calls on RecyclerView</h2>

<ul>
  <li>Measure it by extending RV and counting <code class="highlighter-rouge">requestLayout()</code> calls</li>
  <li>ImageView
    <ul>
      <li>use fixed width, height if you can and put a placeholder with the same width height. See https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/widget/ImageView.java#585</li>
      <li>use AspectRatioImageView</li>
    </ul>
  </li>
  <li>TextView: TBD</li>
  <li>Use <code class="highlighter-rouge">recyclerView.setHasFixedSize(true)</code> to prevent remeasuring when item views change.</li>
</ul>

<h2 id="note-3---livedata-postvalue-vs-value">NOTE 3 - LiveData <code class="highlighter-rouge">postValue()</code> vs <code class="highlighter-rouge">value=</code></h2>

<ul>
  <li><code class="highlighter-rouge">postValue()</code> is for posting LiveData value from a different thread</li>
  <li><code class="highlighter-rouge">postValue()</code> is much slower (more than 100ms vs less than 10ms) therefore use <code class="highlighter-rouge">value=</code> if possible</li>
</ul>

<h2 id="note-4---reading-from-room-database">NOTE 4 - Reading from Room database</h2>

<ul>
  <li>Observing values is slower than getting them. Use get, render the view than observe the value for changes.</li>
</ul>

<h2 id="note-5---image-loading-with-glide">NOTE 5 - Image loading with Glide</h2>
<ul>
  <li>Use <code class="highlighter-rouge">placeholder()</code> to prevent a <code class="highlighter-rouge">setImageDrawable()</code> call with a <code class="highlighter-rouge">null</code> value, which causes remeasurement</li>
  <li>Make sure placeholder size is equal to the loaded image. Resize the loaded image to keep the sizes the same</li>
</ul>

<h2 id="note-6---using-androidtextformatdateutils">NOTE 6 - Using <code class="highlighter-rouge">android.text.format.DateUtils</code></h2>
<ul>
  <li>The first call to <code class="highlighter-rouge">DateUtils.getRelativeDateTimeString</code> takes about 400ms in average, subsequent calls take 2-8ms</li>
  <li>Make a dummy call <code class="highlighter-rouge">getRelativeDateTimeString</code> on a background thread to avoid spending that time when loading a screen</li>
</ul>

<h2 id="note-7---use-sparsearray-or-arraymap-for-performance">NOTE 7 - Use SparseArray or ArrayMap for performance</h2>
<ul>
  <li>Boxing: int -&gt; Integer</li>
  <li>Unboxing: Integer -&gt; int</li>
  <li><a href="https://android.jlelse.eu/autoboxing-a-little-thing-can-cause-big-problems-for-android-app-performance-1fb6cb1e48dd">Source</a></li>
</ul>

<h2 id="note-8---gradle-build-time">NOTE 8 - Gradle build time</h2>
<ul>
  <li><code class="highlighter-rouge">org.gradle.daemon=true</code></li>
  <li><code class="highlighter-rouge">org.gradle.parallel=true</code></li>
  <li><a href="https://android.jlelse.eu/speeding-up-gradle-builds-619c442113cb#.thj9h2pqd">source</a> &amp; <a href="https://www.jrebel.com/blog/making-gradle-builds-faster">source</a></li>
</ul>

  </div></div>

      </section>
    </main></body>
</html>
